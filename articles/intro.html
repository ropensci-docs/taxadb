<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="taxadb">
<title>Tutorial for taxadb • taxadb</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial for taxadb">
<meta property="og:description" content="taxadb">
<meta property="og:image" content="https://docs.ropensci.org/taxadb/logo.svg">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">taxadb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.1.99</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro.html">Tutorial for taxadb</a>
    <a class="dropdown-item" href="../articles/backends.html">Backends for taxadb</a>
    <a class="dropdown-item" href="../articles/data-sources.html">Name Providers and schema used in taxadb</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/taxadb/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Tutorial for taxadb</h1>
                        <h4 data-toc-skip class="author">Carl Boettiger, Kari Norman</h4>
            
            <h4 data-toc-skip class="date">2020-02-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/taxadb/blob/HEAD/vignettes/articles/intro.Rmd" class="external-link"><code>vignettes/articles/intro.Rmd</code></a></small>
      <div class="d-none name"><code>intro.Rmd</code></div>
    </div>

    
    
<p>The goal of <code>taxadb</code> is to provide <em>fast</em>, <em>consistent</em> access to taxonomic data, supporting common tasks such as resolving taxonomic names to identifiers, looking up higher classification ranks of given species, or returning a list of all species below a given rank. These tasks are particularly common when synthesizing data across large species assemblies, such as combining occurrence records with trait records.</p>
<p>Existing approaches to these problems typically rely on web APIs, which can make them impractical for work with large numbers of species or in more complex pipelines. Queries and returned formats also differ across the different taxonomic authorities, making tasks that query multiple authorities particularly complex. <code>taxadb</code> creates a <em>local</em> database of most readily available taxonomic authorities, each of which is transformed into consistent, standard, and researcher-friendly tabular formats.</p>
<div class="section level2">
<h2 id="install-and-initial-setup">Install and initial setup<a class="anchor" aria-label="anchor" href="#install-and-initial-setup"></a>
</h2>
<p>To get started, install the development version directly from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ropensci/taxadb"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">taxadb</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># Used to illustrate how a typical workflow combines nicely with `dplyr`</span></span></code></pre></div>
<p>Create a local copy of the Catalogue of Life (2018) database:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">td_create</span>(<span class="st">"col"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Importing 2019_common_col.tsv.bz2 in 100000 line chunks:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>[<span class="sc">-</span>] chunk <span class="dv">2</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>[\] chunk <span class="dv">3</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>[<span class="sc">|</span>] chunk <span class="dv">4</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>[<span class="sc">/</span>] chunk <span class="dv">5</span> ...Done<span class="sc">!</span> (<span class="cf">in</span> <span class="fl">9.042107</span> secs)</span></code></pre></div>
<p>Read in the species list used by the Breeding Bird Survey:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bbs_species_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/bbs.tsv"</span>, package<span class="op">=</span><span class="st">"taxadb"</span><span class="op">)</span></span>
<span><span class="va">bbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">bbs_species_list</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-names-and-ids">Getting names and ids<a class="anchor" aria-label="anchor" href="#getting-names-and-ids"></a>
</h2>
<p>Two core functions are <code><a href="../reference/get_ids.html">get_ids()</a></code> and <code><a href="../reference/get_names.html">get_names()</a></code>. These functions take a vector of names or ids (respectively), and return a vector of ids or names (respectively). For instance, we can use this to attempt to resolve all the bird names in the Breeding Bird Survey against the Catalogue of Life:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">birds</span> <span class="op">&lt;-</span> <span class="va">bbs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="../reference/get_ids.html">get_ids</a></span><span class="op">(</span><span class="va">species</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">birds</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt;                          species           id</span></span>
<span><span class="co">#&gt; 1         Dendrocygna autumnalis COL:35517330</span></span>
<span><span class="co">#&gt; 2            Dendrocygna bicolor COL:35517332</span></span>
<span><span class="co">#&gt; 3                Anser canagicus COL:35517329</span></span>
<span><span class="co">#&gt; 4             Anser caerulescens COL:35517325</span></span>
<span><span class="co">#&gt; 5  Chen caerulescens (blue form)         &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                   Anser rossii COL:35517328</span></span>
<span><span class="co">#&gt; 7                Anser albifrons COL:35517308</span></span>
<span><span class="co">#&gt; 8                Branta bernicla COL:35517301</span></span>
<span><span class="co">#&gt; 9      Branta bernicla nigricans COL:35537100</span></span>
<span><span class="co">#&gt; 10             Branta hutchinsii COL:35536445</span></span></code></pre></div>
<p>Note that some names cannot be resolved to an identifier. This can occur because of miss-spellings, non-standard formatting, or the use of a synonym not recognized by the naming provider. Names that cannot be uniquely resolved because they are known synonyms of multiple different species will also return <code>NA</code>. The <code>filter_name</code> filtering functions can help us resolve this last case (see below).</p>
<p><code><a href="../reference/get_ids.html">get_ids()</a></code> returns the IDs of accepted names, that is <code>dwc:AcceptedNameUsageID</code>s. We can resolve the IDs into accepted names:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">birds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>accepted_name <span class="op">=</span> <span class="fu"><a href="../reference/get_names.html">get_names</a></span><span class="op">(</span><span class="va">id</span>, <span class="st">"col"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         species           id        accepted_name</span></span>
<span><span class="co">#&gt; 1        Dendrocygna autumnalis COL:35517330      Tringa flavipes</span></span>
<span><span class="co">#&gt; 2           Dendrocygna bicolor COL:35517332    Picoides dorsalis</span></span>
<span><span class="co">#&gt; 3               Anser canagicus COL:35517329   Setophaga castanea</span></span>
<span><span class="co">#&gt; 4            Anser caerulescens COL:35517325  Bombycilla cedrorum</span></span>
<span><span class="co">#&gt; 5 Chen caerulescens (blue form)         &lt;NA&gt;       Icteria virens</span></span>
<span><span class="co">#&gt; 6                  Anser rossii COL:35517328 Somateria mollissima</span></span></code></pre></div>
<p>This illustrates that some of our names, e.g. <em>Dendrocygna bicolor</em> are accepted in the Catalogue of Life, while others, <em>Anser canagicus</em> are <strong>known synonyms</strong> of a different accepted name: <strong>Chen canagica</strong>. Resolving synonyms and accepted names to identifiers helps us avoid the possible miss-matches we could have when the same species is known by two different names.</p>
</div>
<div class="section level2">
<h2 id="taxonomic-data-tables">Taxonomic Data Tables<a class="anchor" aria-label="anchor" href="#taxonomic-data-tables"></a>
</h2>
<p>Local access to taxonomic data tables lets us do much more than look up names and ids. A family of <code>filter_*</code> functions in <code>taxadb</code> help us work directly with subsets of the taxonomic data. As we noted above, this can be useful in resolving certain ambiguous names.</p>
<p>For instance, <em>Trochalopteron henrici gucenense</em> does not resolve to an identifier in ITIS:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_ids.html">get_ids</a></span><span class="op">(</span><span class="st">"Trochalopteron henrici gucenense"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; [1] NA</span></span></code></pre></div>
<p>Using <code><a href="../reference/filter_name.html">filter_name()</a></code>, we find this is because the name resolves not to zero matches, but to more than one match:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/filter_name.html">filter_name</a></span><span class="op">(</span><span class="st">"Trochalopteron henrici gucenense"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; # A tibble: 2 x 17</span></span>
<span><span class="co">#&gt;    sort taxonID scientificName taxonRank acceptedNameUsa… taxonomicStatus update_date kingdom phylum class order family genus</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1     1 ITIS:9… Trochaloptero… subspeci… ITIS:916117      synonym         &lt;NA&gt;        Animal… Chord… Aves  Pass… Leiot… Troc…</span></span>
<span><span class="co">#&gt; 2     1 ITIS:9… Trochaloptero… subspeci… ITIS:916116      synonym         &lt;NA&gt;        Animal… Chord… Aves  Pass… Leiot… Troc…</span></span>
<span><span class="co">#&gt; # … with 4 more variables: specificEpithet &lt;chr&gt;, vernacularName &lt;chr&gt;, infraspecificEpithet &lt;chr&gt;, input &lt;chr&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/filter_name.html">filter_name</a></span><span class="op">(</span><span class="st">"Trochalopteron henrici gucenense"</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>acceptedNameUsage <span class="op">=</span> <span class="fu"><a href="../reference/get_names.html">get_names</a></span><span class="op">(</span><span class="va">acceptedNameUsageID</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">scientificName</span>, <span class="va">taxonomicStatus</span>, <span class="va">acceptedNameUsage</span>, <span class="va">acceptedNameUsageID</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 x 4</span></span>
<span><span class="co">#&gt;   scientificName                   taxonomicStatus acceptedNameUsage       acceptedNameUsageID</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                            &lt;chr&gt;           &lt;chr&gt;                   &lt;chr&gt;              </span></span>
<span><span class="co">#&gt; 1 Trochalopteron henrici gucenense synonym         Trochalopteron henrici  ITIS:916117        </span></span>
<span><span class="co">#&gt; 2 Trochalopteron henrici gucenense synonym         Trochalopteron elliotii ITIS:916116</span></span></code></pre></div>
<p>Similar functions <code>filter_id</code>, <code>filter_rank</code>, and <code>filter_common</code> take IDs, scientific ranks, or common names, respectively. Here, we can get taxonomic data on all bird names in the Catalogue of Life:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/filter_rank.html">filter_rank</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Aves"</span>, rank <span class="op">=</span> <span class="st">"class"</span>, provider <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 35,398 x 21</span></span>
<span><span class="co">#&gt;     sort taxonID scientificName acceptedNameUsa… taxonomicStatus taxonRank kingdom phylum class order family genus</span></span>
<span><span class="co">#&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1     1 COL:35… Sturnella mag… COL:35520416     accepted        species   Animal… Chord… Aves  Pass… Icter… Stur…</span></span>
<span><span class="co">#&gt;  2     1 COL:35… Tauraco porph… COL:35530219     accepted        infraspe… Animal… Chord… Aves  Muso… Musop… Taur…</span></span>
<span><span class="co">#&gt;  3     1 COL:35… Pyroderus scu… COL:35534370     accepted        infraspe… Animal… Chord… Aves  Pass… Cotin… Pyro…</span></span>
<span><span class="co">#&gt;  4     1 COL:35… Dromaius minor COL:35552206     synonym         infraspe… Animal… Chord… Aves  Casu… Droma… Drom…</span></span>
<span><span class="co">#&gt;  5     1 COL:35… Lepidocolapte… COL:35525495     accepted        species   Animal… Chord… Aves  Pass… Furna… Lepi…</span></span>
<span><span class="co">#&gt;  6     1 COL:35… Casuarius pap… COL:35552204     synonym         infraspe… Animal… Chord… Aves  Casu… Casua… Casu…</span></span>
<span><span class="co">#&gt;  7     1 COL:35… Forpus modest… COL:35536431     accepted        species   Animal… Chord… Aves  Psit… Psitt… Forp…</span></span>
<span><span class="co">#&gt;  8     1 COL:35… Pterocnemia p… COL:35552203     synonym         infraspe… Animal… Chord… Aves  Rhei… Rheid… Rhea </span></span>
<span><span class="co">#&gt;  9     1 COL:35… Ceyx lepidus … COL:35532279     accepted        infraspe… Animal… Chord… Aves  Cora… Alced… Ceyx </span></span>
<span><span class="co">#&gt; 10     1 COL:35… Rhea tarapace… COL:35552202     synonym         infraspe… Animal… Chord… Aves  Rhei… Rheid… Rhea </span></span>
<span><span class="co">#&gt; # … with 35,388 more rows, and 9 more variables: specificEpithet &lt;chr&gt;, infraspecificEpithet &lt;chr&gt;, taxonConceptID &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   isExtinct &lt;chr&gt;, nameAccordingTo &lt;chr&gt;, namePublishedIn &lt;chr&gt;, scientificNameAuthorship &lt;chr&gt;, vernacularName &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   input &lt;chr&gt;</span></span></code></pre></div>
<p>Combining these with <code>dplyr</code> functions can make it easy to explore this data: for instance, which families have the most species?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/filter_rank.html">filter_rank</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Aves"</span>, rank <span class="op">=</span> <span class="st">"class"</span>, provider <span class="op">=</span> <span class="st">"col"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">taxonomicStatus</span> <span class="op">==</span> <span class="st">"accepted"</span>, <span class="va">taxonRank</span><span class="op">==</span><span class="st">"species"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">family</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span>sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 x 2</span></span>
<span><span class="co">#&gt; # Groups:   family [6]</span></span>
<span><span class="co">#&gt;   family           n</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 Tyrannidae     401</span></span>
<span><span class="co">#&gt; 2 Thraupidae     374</span></span>
<span><span class="co">#&gt; 3 Psittacidae    370</span></span>
<span><span class="co">#&gt; 4 Trochilidae    338</span></span>
<span><span class="co">#&gt; 5 Muscicapidae   314</span></span>
<span><span class="co">#&gt; 6 Columbidae     312</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-the-database-connection-directly">Using the database connection directly<a class="anchor" aria-label="anchor" href="#using-the-database-connection-directly"></a>
</h2>
<p><code>filter_*</code> functions by default return in-memory data frames. Because they are filtering functions, they return a subset of the full data which matches a given query (names, ids, ranks, etc), so the returned data.frames are smaller than the full record of a naming provider. Working directly with the SQL connection to the MonetDBLite database gives us access to all the data. The <code><a href="../reference/taxa_tbl.html">taxa_tbl()</a></code> function provides this connection:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/taxa_tbl.html">taxa_tbl</a></span><span class="op">(</span><span class="st">"col"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Source:   table&lt;2019_dwc_col&gt; [?? x 19]</span></span>
<span><span class="co">#&gt; # Database: duckdb_connection</span></span>
<span><span class="co">#&gt;    taxonID scientificName acceptedNameUsa… taxonomicStatus taxonRank kingdom phylum class order family genus specificEpithet</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;          </span></span>
<span><span class="co">#&gt;  1 COL:31… Limacoccus br… COL:316423       accepted        species   Animal… Arthr… Inse… Hemi… Beeso… Lima… brasiliensis   </span></span>
<span><span class="co">#&gt;  2 COL:31… Coccus bromel… COL:316424       accepted        species   Animal… Arthr… Inse… Hemi… Cocci… Cocc… bromeliae      </span></span>
<span><span class="co">#&gt;  3 COL:31… Apiomorpha po… COL:316425       accepted        species   Animal… Arthr… Inse… Hemi… Erioc… Apio… pomaphora      </span></span>
<span><span class="co">#&gt;  4 COL:31… Eriococcus ch… COL:316441       accepted        species   Animal… Arthr… Inse… Hemi… Erioc… Erio… chaoticus      </span></span>
<span><span class="co">#&gt;  5 COL:31… Eriococcus ch… COL:316442       accepted        species   Animal… Arthr… Inse… Hemi… Erioc… Erio… chathamensis   </span></span>
<span><span class="co">#&gt;  6 COL:31… Eriococcus ch… COL:316443       accepted        species   Animal… Arthr… Inse… Hemi… Erioc… Erio… chilensis      </span></span>
<span><span class="co">#&gt;  7 COL:31… Eriococcus ci… COL:316444       accepted        species   Animal… Arthr… Inse… Hemi… Erioc… Erio… cingulatus     </span></span>
<span><span class="co">#&gt;  8 COL:31… Eriococcus ci… COL:316445       accepted        species   Animal… Arthr… Inse… Hemi… Erioc… Erio… cistacearum    </span></span>
<span><span class="co">#&gt;  9 COL:31… Eriococcus bu… COL:316447       accepted        species   Animal… Arthr… Inse… Hemi… Erioc… Erio… busariae       </span></span>
<span><span class="co">#&gt; 10 COL:31… Eriococcus au… COL:316450       accepted        species   Animal… Arthr… Inse… Hemi… Erioc… Erio… australis      </span></span>
<span><span class="co">#&gt; # … with more rows, and 7 more variables: infraspecificEpithet &lt;chr&gt;, taxonConceptID &lt;chr&gt;, isExtinct &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   nameAccordingTo &lt;chr&gt;, namePublishedIn &lt;chr&gt;, scientificNameAuthorship &lt;chr&gt;, vernacularName &lt;chr&gt;</span></span></code></pre></div>
<p>We can still use most familiar <code>dplyr</code> verbs to perform common tasks. For instance: which species has the most known synonyms?</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/taxa_tbl.html">taxa_tbl</a></span><span class="op">(</span><span class="st">"col"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">acceptedNameUsageID</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Source:     lazy query [?? x 2]</span></span>
<span><span class="co">#&gt; # Database:   duckdb_connection</span></span>
<span><span class="co">#&gt; # Ordered by: desc(n)</span></span>
<span><span class="co">#&gt;    acceptedNameUsageID     n</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;               &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 COL:43082445          456</span></span>
<span><span class="co">#&gt;  2 COL:43081989          373</span></span>
<span><span class="co">#&gt;  3 COL:43124375          329</span></span>
<span><span class="co">#&gt;  4 COL:43353659          328</span></span>
<span><span class="co">#&gt;  5 COL:43223150          322</span></span>
<span><span class="co">#&gt;  6 COL:43337824          307</span></span>
<span><span class="co">#&gt;  7 COL:43124158          302</span></span>
<span><span class="co">#&gt;  8 COL:43081973          296</span></span>
<span><span class="co">#&gt;  9 COL:43333057          253</span></span>
<span><span class="co">#&gt; 10 COL:23162697          252</span></span>
<span><span class="co">#&gt; # … with more rows</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
